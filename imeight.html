<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>imeight screen</title>
	<script>
		var DEBUG = true
	</script>
	<script type="text/javascript" src="memory.js"></script>
	<script type="text/javascript" src="font.js"></script>
	<script type="text/javascript" src="pixmap-array.js"></script>
	<script type="text/javascript" src="palettes.js"></script>
	<script type="text/javascript" src="tiles.js"></script>
	<script type="text/javascript" src="text.js"></script>
	<script type="text/javascript" src="sprites.js"></script>
	<script type="text/javascript" src="initial_memory_content.js"></script>
	<style type="text/css">
		#tile-layer {
			position: absolute;
			left: 0;
			top: 0;
			z-index: 0;
		}
		#text-layer {
			position: absolute;
			left: 0;
			top: 0;
			z-index: 2;
		}
		.sprite0 {
			position: absolute;
			z-index: 1;
		}
		.sprite1 {
			position: absolute;
			z-index: 1;
		}
		.sprite2 {
			position: absolute;
			z-index: 1;
		}
		.sprite3 {
			position: absolute;
			z-index: 1;
		}
	</style>
	<script>
		function init() {
			paletteInit()
			tileInit()
			
			for(var i = 0; i < 21504; ++i) {
				writeMemory(i, 0)
			}
      initMemory()
			setInterval(updateDirtyMirrors, 1000/25)
			
			//testing123
			for(var i = 0; i < 576; ++i) {
				writeMemory(TILE_LAYER + i, 4)
			}
			writeMemory(PIXMAP_ORIGO + 4*72, 15)
			writeMemory(PIXMAP_ORIGO + 4*72 + 71, 15*16)
			writeMemory(PALETTES, 0)
			writeMemory(PALETTES + 15, 0)
			writeMemory(-1, 12.5)

			setInterval(function() {
				writeMemory(PALETTES + 15, (memory[PALETTES + 15] + 1)&255)
			}, 97)
		}
	</script>
</head>

<body onload="init()">
	<canvas id="tile-layer" width="768" height="432"></canvas>
	<canvas id="text-layer" width="768" height="432"></canvas>
</body>
</html>
